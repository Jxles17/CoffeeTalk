{% extends 'base.html.twig' %}

{% block title %}Ajouter des points de fidélité{% endblock %}

{% block body %}
<style>
ul { list-style-type: none; padding: 0; }
li { padding: 10px; border-bottom: 1px solid #ccc; display: flex; justify-content: space-between; align-items: center; }
.user-info { flex-grow: 1; }
.add-points-form { display: flex; align-items: center; justify-content: center; }
.eye-icon { margin-left: 10px; cursor: pointer; }
</style>

<h1>Liste des utilisateurs</h1>
<form method="get" action="{{ path('user_list') }}">
    <input type="text" name="search" placeholder="Rechercher par nom ou email" value="{{ app.request.query.get('search') }}">
    <button type="submit">Rechercher</button>
</form>
<ul>
    <li>
        <div class="user-info"><strong>Nom d'utilisateur</strong></div>
        <div class="user-info"><strong>Email</strong></div>
        <div class="user-info"><strong>Points de fidélité</strong></div>
        <div class="user-info"><strong>Action</strong></div>
    </li>
    {% for user in users %}
        <li>
            <div class="user-info">
                {{ user.username }}
                <a href="{{ path('add_loyalty_points_user', {'id': user.id}) }}" class="eye-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
                        <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.07-.122.149-.195.232a13.133 13.133 0 0 1-1.66 2.043C11.88 11.332 10.12 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.133 13.133 0 0 1 1.172 8z"/>
                        <path d="M8 5a3 3 0 1 0 0 6 3 3 0 0 0 0-6zm0 1a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"/>
                    </svg>
                </a>
            </div>
            <div class="user-info" style="text-align: center;">{{ user.email }}</div>
            <div class="user-info" style="text-align: center;">{{ user.loyaltyPoints }}</div>
            <div class="user-info">
                <form action="{{ path('add_loyalty_points') }}" method="post" class="add-points-form">
                    <input type="hidden" name="email" value="{{ user.email }}">
                    <input type="number" name="points" min="1" value="1" required>
                    <input type="hidden" name="action" value="add">
                    <button type="submit" class="btn">Ajouter</button>
                </form>
                <form action="{{ path('add_loyalty_points') }}" method="post" class="add-points-form">
                    <input type="hidden" name="email" value="{{ user.email }}">
                    <input type="number" name="points" min="1" value="1" required>
                    <input type="hidden" name="action" value="deduct">
                    <button type="submit" class="btn">Enlever</button>
                </form>
            </div>
        </li>
    {% endfor %}
</ul>
{% endblock %}
